<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Frosted Glass Lamp – HTML Widget</title>
  <style>
    :root{
      --glow-r: 255;
      --glow-g: 184;
      --glow-b: 79;
      --brightness: 70;
      --rib-opacity: 0.35;
      --glass-tint: 255,255,255;
      --edge-dark: 24, 24, 28;
      --noise-opacity: .1;
      --corner: 28px;
      --bg-color: #121212;
      --text-color: #e9e9e9;
      --panel-bg: #1e1e1e;
    }

    *{ box-sizing: border-box; }
    html, body{
      height:100%;
      margin:0;
      background: var(--bg-color);
      color: var(--text-color);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial;
      transition: background 0.3s ease, color 0.3s ease;
    }

    body.light{
      --bg-color: #e9e6e3;
      --text-color: #1f2328;
      --panel-bg: #ffffff;
    }

    .page{
      display:grid;
      grid-template-columns: 1fr 380px;
      gap: 22px;
      height:100%;
      padding: 20px;
    }

    .frame-wrap{
      display:grid;
      place-items:center;
      width:100%; height:100%;
    }

    .frame{
      position:relative;
      width:min(92vh, 100%);
      height:min(92vh, 100%);
      max-width:100%;
      max-height:100%;
      aspect-ratio: 1 / 2;
      display:flex; align-items:center; justify-content:center;
      border-radius: var(--corner);
      background: transparent;
      overflow:hidden;
      box-shadow: 0 30px 70px rgba(0,0,0,.25);
      transition: border-radius .3s ease;
    }

    .glass{
      position:absolute; inset:0;
      border-radius: inherit;
      background:
        radial-gradient(120% 100% at -10% 50%, rgba(var(--edge-dark), .22), transparent 45%),
        radial-gradient(120% 100% at 110% 50%, rgba(var(--edge-dark), .22), transparent 45%),
        linear-gradient(180deg, rgba(var(--glass-tint),.55), rgba(var(--glass-tint),.35));
    }

    .ribs{
      position:absolute; inset:0; border-radius:inherit; pointer-events:none;
      background:
        repeating-linear-gradient(var(--rib-angle, 90deg),
          rgba(255,255,255, calc(var(--rib-opacity) * .35)) 0 1px,
          rgba(200,200,210, calc(var(--rib-opacity) * .35)) 1px 2px,
          rgba(150,150,160, 0) 2px 5px);
      opacity:.9;
    }

    .grain{ position:absolute; inset:0; border-radius:inherit; pointer-events:none; }
    .grain::before{ content:""; position:absolute; inset:-50%; background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300" viewBox="0 0 300 300"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="1.2" numOctaves="2" stitchTiles="stitch"/><feColorMatrix type="saturate" values="0"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.45"/></svg>'); background-size: 300px 300px; opacity: var(--noise-opacity); mix-blend-mode: soft-light; }

    .glow{
      position:absolute; inset: 10%; border-radius: calc(var(--corner) * .6);
      filter: blur(calc(1px + (var(--brightness) / 100 * 10px)));
      background:
        radial-gradient(closest-side at 50% 50%, rgba(var(--glow-r), var(--glow-g), var(--glow-b), calc(var(--brightness)/220)), rgba(0,0,0,0) 66%),
        linear-gradient(var(--glow-deg, 0deg), rgba(var(--glow-r), var(--glow-g), var(--glow-b), calc(var(--brightness)/150)) 30%, rgba(0,0,0,0) 72%);
      box-shadow:
        0 0 calc(20px + 40px * (var(--brightness)/100)) rgba(var(--glow-r), var(--glow-g), var(--glow-b), calc(var(--brightness)/180));
    }

    .glass::after{
      content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
      background: linear-gradient(180deg, rgba(255,255,255,.35), rgba(255,255,255,0) 28%, rgba(0,0,0,.06) 65%, rgba(0,0,0,.18));
      mix-blend-mode: screen; opacity:.8;
    }

    .panel{
      background: var(--panel-bg);
      border-radius: 18px;
      padding:18px 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.08), inset 0 1px 0 rgba(255,255,255,.1);
      display:flex; flex-direction:column; gap:14px;
      transition: background 0.3s ease;
    }
    .panel h2{ margin:0 0 6px; font-size:1.1rem; }
    .row{ display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:center; }
    .subgrid{ display:grid; gap:8px; }
    .pill{ display:flex; gap:8px; background:#444; padding:6px; border-radius:999px; width:max-content; }
    .pill button{ border:0; background:transparent; padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:600; color:#ddd; }
    .pill button[aria-pressed="true"]{ background:#222; box-shadow:0 1px 2px rgba(0,0,0,.08); color:#fff; }

    input[type="range"]{ width:100%; }
    .inline{ display:flex; align-items:center; gap:10px; }
    .swatch{ width:26px; height:26px; border-radius:8px; box-shadow: inset 0 0 0 1px rgba(0,0,0,.12); }
    .muted{ color:#aaa; font-size:.92rem; }

    .toggle-btn {
      cursor:pointer; border:none; border-radius:8px; padding:8px 12px; font-weight:600;
      background:#333; color:#fff; align-self:flex-end;
      transition:background .3s ease;
    }
    body.light .toggle-btn { background:#ddd; color:#111; }

    @media (max-width: 900px){
      .page{ grid-template-columns: 1fr; grid-template-rows: auto auto; }
      .frame{ width:100%; aspect-ratio: 2/3; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="frame-wrap">
      <div class="frame" id="lampFrame">
        <div class="glass"></div>
        <div class="ribs" id="ribs"></div>
        <div class="grain"></div>
        <div class="glow" id="glow"></div>
      </div>
    </div>

    <aside class="panel">
      <button id="themeToggle" class="toggle-btn">☾ Dark Mode</button>
      <h2>Lamp Controls</h2>
      <div class="row">
        <label for="brightness"><strong>Brightness</strong></label>
        <div class="inline"><span id="bVal" class="muted">70</span></div>
      </div>
      <input id="brightness" type="range" min="0" max="100" value="70" />

      <div class="subgrid">
        <div class="pill" role="tablist">
          <button id="modeRGB" aria-pressed="true">RGB</button>
          <button id="modeWhite" aria-pressed="false">White</button>
        </div>

        <div id="rgbControls">
          <div class="row">
            <label for="rgb">Color</label>
            <div class="inline"><div id="swatch" class="swatch" style="background: rgb(255,184,79);"></div></div>
          </div>
          <input id="rgb" type="color" value="#ffb84f" />
        </div>

        <div id="whiteControls" style="display:none">
          <div class="row">
            <label for="cct">White (Cold → Warmest)</label>
            <div class="inline"><span id="cctLabel" class="muted">3500K</span></div>
          </div>
          <input id="cct" type="range" min="0" max="100" value="50" />
        </div>
      </div>

      <div class="row">
        <label for="ribbing">Frost Ribbing</label>
        <div class="inline"><span id="ribVal" class="muted">35%</span></div>
      </div>
      <input id="ribbing" type="range" min="0" max="100" value="35" />
    </aside>
  </div>

  <script>
    const frame = document.getElementById('lampFrame');
    const glow = document.getElementById('glow');
    const b = document.getElementById('brightness');
    const bVal = document.getElementById('bVal');
    const rgb = document.getElementById('rgb');
    const swatch = document.getElementById('swatch');
    const cct = document.getElementById('cct');
    const cctLabel = document.getElementById('cctLabel');
    const modeRGB = document.getElementById('modeRGB');
    const modeWhite = document.getElementById('modeWhite');
    const rgbControls = document.getElementById('rgbControls');
    const whiteControls = document.getElementById('whiteControls');
    const ribs = document.getElementById('ribs');
    const ribbing = document.getElementById('ribbing');
    const ribVal = document.getElementById('ribVal');
    const themeToggle = document.getElementById('themeToggle');

    const css = (prop, val) => document.documentElement.style.setProperty(prop, val);

    function hexToRgb(hex){
      const v = hex.replace('#','');
      return [parseInt(v.slice(0,2),16), parseInt(v.slice(2,4),16), parseInt(v.slice(4,6),16)];
    }

    function cctToRgb(p){
      const cold = [180, 200, 255];
      const neutral = [255, 244, 229];
      const warm = [255, 180, 60];
      const m = p < .5 ? lerpColor(cold, neutral, p/.5) : lerpColor(neutral, warm, (p-.5)/.5);
      return m;
    }
    function lerpColor(a,b,t){ return [Math.round(a[0]+(b[0]-a[0])*t),Math.round(a[1]+(b[1]-a[1])*t),Math.round(a[2]+(b[2]-a[2])*t)]; }

    function updateBrightness(){ css('--brightness', b.value); bVal.textContent = b.value; }
    function setRgb([r,g,b]){ css('--glow-r', r); css('--glow-g', g); css('--glow-b', b); swatch.style.background = `rgb(${r},${g},${b})`; }
    function handleRgbChange(){ setRgb(hexToRgb(rgb.value)); }
    function handleCctChange(){ const p = +cct.value / 100; const [r,g,b] = cctToRgb(p); setRgb([r,g,b]); const temp = Math.round(6500 - (6500-1800)*p); cctLabel.textContent = temp+'K'; }

    function setMode(which){ const rgbMode = which === 'rgb'; rgbControls.style.display = rgbMode?'block':'none'; whiteControls.style.display = rgbMode?'none':'block'; modeRGB.setAttribute('aria-pressed', rgbMode); modeWhite.setAttribute('aria-pressed', !rgbMode); if(!rgbMode) handleCctChange(); else handleRgbChange(); }

    function updateOrientation(){ const rect = frame.getBoundingClientRect(); const longIsHorizontal = rect.width >= rect.height; css('--glow-deg', longIsHorizontal?'90deg':'0deg'); ribs.style.setProperty('--rib-angle', longIsHorizontal?'0deg':'90deg'); }
    function updateRibbing(){ const value = ribbing.value; css('--rib-opacity', (value/100).toFixed(2)); ribVal.textContent = value+'%'; }

    b.addEventListener('input', updateBrightness);
    rgb.addEventListener('input', handleRgbChange);
    cct.addEventListener('input', handleCctChange);
    ribbing.addEventListener('input', updateRibbing);
    modeRGB.addEventListener('click', ()=>setMode('rgb'));
    modeWhite.addEventListener('click', ()=>setMode('white'));

    const ro = new ResizeObserver(updateOrientation);
    ro.observe(frame);
    window.addEventListener('resize', updateOrientation);

    themeToggle.addEventListener('click', ()=>{
      document.body.classList.toggle('light');
      themeToggle.textContent = document.body.classList.contains('light') ? '☀ Light Mode' : '☾ Dark Mode';
    });

    updateBrightness();
    handleRgbChange();
    updateOrientation();
    updateRibbing();
  </script>
</body>
</html>
